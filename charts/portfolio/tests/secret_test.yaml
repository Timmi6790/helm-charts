suite: test secret
templates:
  - secret.yaml
tests:
  - it: should not create secret when secretName is provided
    set:
      application.github.secretName: external-secret
    asserts:
      - hasDocuments:
          count: 0

  - it: should create secret when token is provided
    set:
      application.github.token: ghp_test123456
    asserts:
      - isKind:
          of: Secret
      - equal:
          path: type
          value: Opaque
      - equal:
          path: stringData.GITHUB_TOKEN
          value: ghp_test123456

  - it: should not create secret when neither secretName nor token is provided
    asserts:
      - hasDocuments:
          count: 0
